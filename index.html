<!DOCTYPE html>
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Christ Love Ministries | Rundu Branch</title>  
    <script src="https://cdn.tailwindcss.com"></script>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">  
    <style>  
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');  
        body { font-family: 'Poppins', sans-serif; background: #020617; color: white; margin: 0; overflow-x: hidden; }  

        /* Background Slideshow */  
        #bg-slideshow { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }  
        .bg-slide { position: absolute; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 1.5s ease; }  
        .bg-slide.active { opacity: 0.35; }  

        /* UI Layers */  
        #app-container { position: relative; z-index: 10; min-height: 100vh; transition: filter 0.3s; }  
        .content-blur { filter: blur(15px); pointer-events: none; }  

        /* Glass Styling */  
        .glass { background: rgba(30, 58, 138, 0.15); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 1.5rem; cursor: pointer; transition: all 0.3s ease; }  
        .glass:hover { transform: translateY(-5px); background: rgba(30, 58, 138, 0.3); border-color: #3b82f6; }  

        /* Tab System */  
        .tab-page { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: rgba(2, 6, 23, 0.98); backdrop-filter: blur(20px); display: none; flex-direction: column; padding: 2rem; overflow-y: auto; }  
        .tab-page.active { display: flex; animation: fadeIn 0.4s ease; }  

        .back-btn { display: inline-flex; align-items: center; gap: 0.75rem; padding: 0.8rem 1.6rem; background: #2563eb; border-radius: 50px; color: white; font-weight: 700; cursor: pointer; margin-bottom: 2rem; width: fit-content; border: none; }  

        /* Status Indicator */
        .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; }
        .status-online { background: #22c55e; box-shadow: 0 0 10px #22c55e; }
        .status-offline { background: #ef4444; box-shadow: 0 0 10px #ef4444; }

        /* AI Joshua Styling */  
        #ai-button { position: fixed; bottom: 20px; right: 20px; z-index: 150; }  
        #chat-window { position: fixed; bottom: 90px; right: 20px; width: 340px; height: 500px; background: #0f172a; border: 1px solid #3b82f6; border-radius: 1.5rem; z-index: 150; display: none; flex-direction: column; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.6); }  
        .message { padding: 12px; border-radius: 1rem; margin: 6px; max-width: 85%; font-size: 0.85rem; line-height: 1.5; word-wrap: break-word; }  
        .bot { background: #1e3a8a; align-self: flex-start; color: #dbeafe; border-bottom-left-radius: 0; }  
        .user { background: #3b82f6; align-self: flex-end; color: white; border-bottom-right-radius: 0; }  
        .typing { color: #93c5fd; font-size: 0.7rem; margin-left: 10px; font-style: italic; display: none; margin-bottom: 5px; }

        input, select { width: 100%; padding: 12px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white; margin-bottom: 15px; }  
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }  
    </style>
</head>  
<body>

<div id="bg-slideshow">  
    <img src="https://images.unsplash.com/photo-1438232992991-995b7058bbb3?q=80&w=1920" class="bg-slide active">  
    <img src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?q=80&w=1920" class="bg-slide">  
</div>  

<div id="app-container">  
    <header class="text-center py-12 px-4 relative">  
        <div class="w-32 h-32 mx-auto bg-slate-800 rounded-full mb-4 border-4 border-blue-500 overflow-hidden">  
            <img src="Title Logo.png" alt="Logo" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/150?text=CLM'">  
        </div>  
        <h1 class="text-4xl font-bold">Christ Love Ministries</h1>  
        <p class="text-blue-400 tracking-[0.3em] font-bold uppercase text-xs">Rundu Branch â€¢ Namibia</p>  
        <button onclick="toggleSidebar()" class="absolute top-8 right-8 text-3xl"><i class="fas fa-bars"></i></button>  
    </header>  

    <main class="max-w-5xl mx-auto px-6 grid grid-cols-1 sm:grid-cols-2 gap-6 pb-24">  
        <div class="glass p-8 text-center" onclick="openTab('vision')">Vision</div>  
        <div class="glass p-8 text-center" onclick="openTab('mission')">Mission</div>  
        <div class="glass p-8 text-center" onclick="openTab('services')">Services</div>  
        <div class="glass p-8 text-center sm:col-span-2 border-2 border-blue-500/40" onclick="openTab('join')">Join Choir or Ushers</div>  
    </main>  
</div>  

<div id="sidebar" class="fixed top-0 right-[-320px] w-80 h-full bg-slate-900 z-[110] transition-all duration-300 p-10 border-l border-blue-500/30">  
    <button onclick="toggleSidebar()" class="text-2xl mb-10"><i class="fas fa-times"></i></button>  
    <nav class="flex flex-col gap-6 text-xl">  
        <a href="javascript:void(0)" onclick="openTab('anchor', true)">2026 Mandate</a>  
        <hr class="border-white/10">  
        <a href="https://www.instagram.com/clmi_rundu" target="_blank">Instagram</a>  
    </nav>  
</div>  

<div id="join" class="tab-page">
    <button class="back-btn" onclick="smartClose()"><i class="fas fa-arrow-left"></i> Back</button>
    <div class="max-w-xl mx-auto">
        <h2 class="text-3xl font-bold text-blue-400 mb-4 text-center">Ministry Enlistment</h2>
        <form onsubmit="submitToWhatsApp(event)" class="glass p-8">
            <input type="text" id="join-name" required placeholder="Full Name">
            <input type="tel" id="join-phone" required placeholder="Phone Number">
            <select id="join-ministry" required>
                <option value="Choir">The Choir</option>
                <option value="Ushers">The Royal Ushers</option>
            </select>
            <button type="submit" class="w-full bg-blue-600 py-4 rounded-xl font-bold"><i class="fab fa-whatsapp mr-2"></i> Submit to Pastor Daniel</button>
        </form>
    </div>
</div>

<button id="ai-button" onclick="toggleChat()" class="bg-blue-600 w-16 h-16 rounded-full shadow-2xl flex items-center justify-center text-2xl">  
    <i class="fas fa-bolt"></i>  
</button>  

<div id="chat-window">  
    <div class="bg-blue-900 p-4 font-bold flex justify-between items-center">  
        <div class="flex items-center">
            <span id="status-light" class="status-dot status-offline"></span>
            <span>Joshua Assistant</span>
        </div>  
        <button onclick="toggleChat()"><i class="fas fa-times"></i></button>  
    </div>  
    <div id="chat-box" class="flex-1 overflow-y-auto p-4 flex flex-col bg-slate-900">  
        <div class="message bot">Grace and peace! Connecting to server...</div>  
    </div>
    <div id="typing-indicator" class="typing">Joshua is thinking...</div>
    <div class="p-3 bg-slate-800 flex gap-2">  
        <input type="text" id="user-input" class="bg-slate-700 border-none rounded-lg p-2 flex-1 text-white text-sm" placeholder="Ask anything..." onkeypress="handleEnter(event)">  
        <button onclick="sendSmartMessage()" class="bg-blue-600 px-4 rounded-lg"><i class="fas fa-paper-plane"></i></button>  
    </div>  
</div>  

<script>  
    const API_KEY = "AIzaSyDGEVFz0hKSFeBtr3B6U3WAv1mtwA2uD0k";
    const PASTOR_PHONE = "+264818970072";

    // Initialize Connection Check
    window.onload = async () => {
        const light = document.getElementById('status-light');
        const box = document.getElementById('chat-box');
        try {
            const check = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: "hi" }] }] })
            });
            if (check.ok) {
                light.className = "status-dot status-online";
                box.innerHTML = `<div class="message bot">Server connected. I am ready to assist you!</div>`;
            } else {
                throw new Error();
            }
        } catch (e) {
            light.className = "status-dot status-offline";
            box.innerHTML = `<div class="message bot text-red-400">Connection Failed. Please check your API key or internet.</div>`;
        }
    };

    // Form Logic
    function submitToWhatsApp(e) {
        e.preventDefault();
        const msg = `Praise God Pastor Daniel. I am ${document.getElementById('join-name').value} (${document.getElementById('join-phone').value}). I wish to join the ${document.getElementById('join-ministry').value}.`;
        window.open(`https://wa.me/${PASTOR_PHONE}?text=${encodeURIComponent(msg)}`, '_blank');
    }

    // AI Logic
    async function sendSmartMessage() {
        const input = document.getElementById('user-input');
        const box = document.getElementById('chat-box');
        const typing = document.getElementById('typing-indicator');
        if (!input.value.trim()) return;

        box.innerHTML += `<div class="message user">${input.value}</div>`;
        const prompt = input.value;
        input.value = '';
        typing.style.display = 'block';
        box.scrollTop = box.scrollHeight;

        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: `You are Joshua, the digital assistant for Christ Love Ministries Rundu. Apostle Joseph K.L is the leader. Keep it spiritual. Question: ${prompt}` }] }]
                })
            });
            const data = await res.json();
            box.innerHTML += `<div class="message bot">${data.candidates[0].content.parts[0].text}</div>`;
        } catch (err) {
            box.innerHTML += `<div class="message bot">Server Error. Please try again.</div>`;
        }
        typing.style.display = 'none';
        box.scrollTop = box.scrollHeight;
    }

    // Nav Helpers
    function toggleSidebar() { const s = document.getElementById('sidebar'); s.style.right = (s.style.right === '0px') ? '-320px' : '0px'; }
    function openTab(id, side=false) { if(side) toggleSidebar(); document.getElementById(id).classList.add('active'); document.getElementById('app-container').classList.add('content-blur'); }
    function smartClose() { document.querySelectorAll('.tab-page').forEach(p => p.classList.remove('active')); document.getElementById('app-container').classList.remove('content-blur'); }
    function handleEnter(e) { if(e.key === 'Enter') sendSmartMessage(); }
    function toggleChat() { const c = document.getElementById('chat-window'); c.style.display = (c.style.display === 'flex') ? 'none' : 'flex'; }
</script>  
</body>  
</html>
